batch_size: 32
num_epochs: 100
patience: 25
data_augmentation:
  colorjitter:
    hue: [-0.1, 0.1]
    saturation: [0.9, 1.1]
  rotation:
    degrees: [-10, 10]
model:
  trunk:
    backbone: convnext_tiny
    # Check this link for details on the preprocessing: https://pytorch.org/vision/stable/models/generated/torchvision.models.convnext_tiny.html#torchvision.models.convnext_tiny
    preprocessing:
      values:
        dtype: float32
        scale: true
      crop_size: 224
      normalization:
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
  embedder:
    embedding_size: 1028
    hidden_layer_sizes:
      - 2056
loss:
  type: circleloss
  config:
    m: 0.4
    gamma: 256
sampler:
  type: mperclass
  config:
    m: 4
optimizers:
  embedder:
    type: adam
    config:
      lr: 0.001
      weight_decay: 0.00001
  trunk:
    type: adam
    config:
      lr: 0.0001
      weight_decay: 0.00001
miner:
  type: batcheasyhardminer
  config:
    pos_strategy: semihard
    neg_strategy: hard
